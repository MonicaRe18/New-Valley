<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ - ØµÙ†Ø¯ÙˆÙ‚ Ø§Ø³ØªØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        /* --- Animation & Global Styles --- */
        @keyframes sway {
            0% { transform: translateX(0) rotate(0); }
            100% { transform: translateX(-2%) rotate(-0.5deg); }
        }
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f0f2f5;
        }
        .background-image-container {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 20%;
            z-index: -1;
            background-size: cover;
            background-position: center;
            display: none;
            animation: sway 20s ease-in-out infinite alternate;
        }
        @media (min-width: 1024px) {
            .background-image-container { display: block; }
        }
        #bg-left {
            left: 0;
            background-image: url('https://images.unsplash.com/photo-1560493676-04071c5f467b?q=80&w=1974&auto=format&fit=crop');
        }
        #bg-right {
            right: 0;
            background-image: url('https://images.unsplash.com/photo-1560493676-04071c5f467b?q=80&w=1974&auto=format&fit=crop');
            transform: scaleX(-1);
            animation-direction: alternate-reverse;
        }

        /* --- Layout Containers --- */
        .main-content-area {
            max-width: 1300px;
            margin: 0 auto;
            padding: 1rem;
        }
        .main-container {
             background-color: #f8fafc;
             padding: 1.5rem;
             border-radius: 1.5rem;
             box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        @media (min-width: 768px) {
            .main-container { padding: 2.5rem; }
        }

        /* --- KPI Card Styles --- */
        .kpi-card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 1rem;
            padding: 1.25rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .kpi-card-interactive:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px 0 rgba(31, 38, 135, 0.15);
            cursor: pointer;
        }
        .kpi-title {
            font-size: 1.1rem; 
            font-weight: 600;
            color: #557A46;
            margin-bottom: 0.5rem;
        }
        .kpi-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #285430;
            line-height: 1.1;
        }
        .kpi-unit {
            font-size: 1rem; 
            font-weight: 500;
            color: #8C7A6B;
            margin-right: 0.35rem;
        }
        .kpi-card-warning {
            background-color: #FFFBEB;
            border-color: #FBBF24;
        }
        .kpi-card-warning .kpi-title { color: #92400E; }
        .kpi-card-warning .kpi-value { color: #D97706; }
        .kpi-card-warning .kpi-unit { color: #B45309; }
        
        /* --- Trend Card Styles --- */
        .kpi-card-trend {
            background: linear-gradient(145deg, #2d6a4f 0%, #1b4332 100%);
            color: white;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2), 0 6px 6px rgba(0,0,0,0.23);
        }
        .kpi-card-trend .kpi-title {
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
            font-weight: 500;
        }
        .kpi-card-trend .kpi-value {
            color: white;
            font-size: 2.25rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        .kpi-card-trend .kpi-unit {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        .kpi-card-trend .trend-indicator-wrapper {
            margin: 0.5rem auto 0;
            display: flex;
            justify-content: center;
        }
        .kpi-card-trend .trend-indicator {
            width: 60px; height: 60px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 700;
        }
        .kpi-card-trend .trend-indicator.up {
            color: #4ade80; 
            background-color: rgba(74, 222, 128, 0.15);
            border: 2px solid rgba(74, 222, 128, 0.5);
        }
        .kpi-card-trend .trend-indicator.down {
            color: #f87171;
            background-color: rgba(248, 113, 113, 0.15);
            border: 2px solid rgba(248, 113, 113, 0.5);
        }
        .kpi-card-trend .trend-indicator svg { width: 1.25rem; height: 1.25rem; }
        .sparkline-container { height: 50px; margin-top: auto; opacity: 0.7; }

        /* --- Section & Chart Styles --- */
        .section-title {
            font-size: 1.75rem; 
            font-weight: 700;
            color: #1a432b;
            margin-bottom: 2rem; 
            text-align: center;
        }
        @media (min-width: 768px) {
            .section-title { font-size: 2.25rem; margin-bottom: 2.5rem; }
        }
        .chart-card {
            background-color: #ffffff;
            border-radius: 1rem;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
        }
        .chart-title {
            text-align: center;
            font-size: 1.25rem;
            font-weight: 600;
            color: #285430;
            margin-bottom: 1rem;
        }
        .chart-container {
            position: relative;
            height: 350px;
            width: 100%;
            max-width: 800px;
            margin: auto;
        }
        .chart-context {
            text-align: center;
            font-size: 0.95rem;
            color: #557A46;
            margin-top: 1.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* --- Modal Styles --- */
        #details-modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); z-index: 999;
            display: none; opacity: 0; transition: opacity 0.3s ease;
            backdrop-filter: blur(5px);
        }
        #details-modal-container {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background-color: #f9fafb; border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            width: 90%; max-width: 900px; max-height: 90vh;
            overflow: hidden; display: none; opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 1000; display: flex; flex-direction: column;
        }
        .modal-header { padding: 1rem 1.5rem; border-bottom: 1px solid #e5e7eb; flex-shrink: 0; }
        .modal-body { padding: 1.5rem; overflow-y: auto; flex-grow: 1; }
        .modal-close-btn {
            background-color: #e5e7eb; color: #4b5563; border-radius: 9999px;
            width: 2rem; height: 2rem; display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; line-height: 1; transition: background-color 0.2s, color 0.2s;
        }
        .modal-close-btn:hover { background-color: #d1d5db; color: #1f2937; }
        #details-modal-overlay.visible { display: block; opacity: 1; }
        #details-modal-container.visible { display: flex; opacity: 1; transform: translate(-50%, -50%) scale(1); }
        
        /* --- Table & Badge Styles --- */
        .professional-table { width: 100%; border-collapse: collapse; }
        .professional-table thead th {
            background-color: #285430; color: white; padding: 0.75rem 1rem;
            text-align: right; font-weight: 600;
        }
        .professional-table tbody td {
            padding: 0.75rem 1rem; border-bottom: 1px solid #e5e7eb; color: #374151;
        }
        .professional-table tbody tr:nth-child(even) { background-color: #f3f4f6; }
        .professional-table tbody tr:hover { background-color: #e5e7eb; }
        .professional-table .icon {
            display: inline-block; vertical-align: middle; margin-left: 8px;
            width: 20px; height: 20px;
        }
        .professional-table .amount { font-weight: 600; }
        .professional-table .amount.overdue { color: #c81e1e; }
        .status-badge {
            padding: 0.25rem 0.75rem; border-radius: 9999px;
            font-weight: 600; font-size: 0.8rem;
        }
        .status-badge.resolved { background-color: #dcfce7; color: #166534; }
        .status-badge.pending { background-color: #fef9c3; color: #854d0e; }
    </style>
</head>
<body class="antialiased">
    <div id="bg-left" class="background-image-container"></div>
    <div id="bg-right" class="background-image-container"></div>
    
    <div class="main-content-area">
        <div class="main-container">
            <!-- Header Section -->
            <header class="text-center mb-8 md:mb-12">
                <div class="flex flex-col sm:flex-row justify-center items-center w-full mb-4 gap-4">
                    <!-- Updated Image Source -->
                    <img src="photo/logo gov.gif" alt="logo gov" class="h-24 md:h-32 w-auto object-contain">
                    <div class="flex-grow mx-4">
                        <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-extrabold text-gray-800">
                            Ù„ÙˆØ­Ø© Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
                        </h1>
                        <p class="text-base md:text-lg text-gray-600 mt-1">ØµÙ†Ø¯ÙˆÙ‚ Ø§Ø³ØªØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ</p>
                    </div>
                    <!-- Updated Image Source -->
                    <img src="photo/logo box.png" alt="logo box" class="h-24 md:h-32 w-auto object-contain">
                </div>
            </header>

            <main>
                <!-- Financial Vision Section -->
                <section id="financial" class="mb-12">
                    <h2 class="section-title">ğŸ’° Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h2>
                    
                    <!-- New Layout for Top Financial Cards -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 mb-8">
                        <!-- Left Column: Stacked Cards -->
                        <div class="flex flex-col gap-6 lg:gap-8">
                            <div data-kpi-id="revenue" class="kpi-card kpi-card-interactive text-center flex-1" data-animate-value="true">
                                <h3 class="kpi-title text-xl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
                                <div><span class="kpi-value text-4xl">75.4</span><span class="kpi-unit text-base">Ù…Ù„ÙŠÙˆÙ†</span></div>
                            </div>
                            <div data-kpi-id="dues-amount" class="kpi-card kpi-card-interactive text-center flex-1" data-animate-value="true">
                                <h3 class="kpi-title text-xl">Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©</h3>
                                <div><span class="kpi-value text-4xl" style="color: #c81e1e;">12.1</span><span class="kpi-unit text-base">Ù…Ù„ÙŠÙˆÙ†</span></div>
                            </div>
                        </div>
                        
                        <!-- Right Column: Tall Trend Card -->
                        <div class="kpi-card kpi-card-trend h-full" data-animate-kpi>
                             <h3 class="kpi-title">Ù†Ù…Ùˆ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠ</h3>
                            <div class="text-center my-auto">
                                <span id="trend-kpi-value" class="kpi-value text-4xl">0.0</span>
                                <span class="kpi-unit text-lg">Ù…Ù„ÙŠÙˆÙ†</span>
                                <div class="trend-indicator-wrapper mt-4">
                                    <div id="trend-indicator" class="trend-indicator !w-20 !h-20"></div>
                                </div>
                            </div>
                            <div class="sparkline-container mt-auto">
                                <canvas id="revenueTrendChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Grid for the rest of the financial cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 lg:gap-8 mb-8 text-center">
                        <div data-kpi-id="overdue" class="kpi-card kpi-card-interactive kpi-card-warning" data-animate-value="false">
                            <h3 class="kpi-title">Ø£Ù‚Ø³Ø§Ø· Ù…ØªØ£Ø®Ø±Ø© (Ø¹Ø¯Ø¯)</h3>
                            <div><span class="kpi-value">245</span><span class="kpi-unit">Ù‚Ø³Ø·</span></div>
                        </div>
                         <div class="kpi-card">
                            <h3 class="kpi-title">Ø£Ø¹Ù„Ù‰ Ù…Ø±ÙƒØ² ØªØ­ØµÙŠÙ„Ø§Ù‹</h3>
                            <div><span id="top-revenue-center" class="kpi-value text-green-600"></span></div>
                        </div>
                         <div class="kpi-card" data-animate-value="true">
                            <h3 class="kpi-title">Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ­ØµÙŠÙ„</h3>
                            <div><span class="kpi-value">86.2</span><span class="kpi-unit">%</span></div>
                        </div>
                    </div>

                     <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
                          <div class="chart-card" data-chart-id="overdueInstallmentsChart">
                            <h3 class="chart-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ØªØ£Ø®Ø±Ø© (Ø¢Ø®Ø± 6 Ø´Ù‡ÙˆØ±)</h3>
                            <div class="chart-container"><canvas id="overdueInstallmentsChart"></canvas></div>
                        </div>
                          <div class="chart-card" data-chart-id="revenueByCenterChart">
                            <h3 class="chart-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø§ÙƒØ²</h3>
                            <div class="chart-container"><canvas id="revenueByCenterChart"></canvas></div>
                        </div>
                     </div>
                </section>
                
                <!-- Allocation Vision Section -->
                <section id="allocation" class="mb-12">
                    <h2 class="section-title">ğŸï¸ Ø±Ø¤ÙŠØ© Ø§Ù„ØªØ®ØµÙŠØµ</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                            <div class="kpi-card text-center" data-animate-value="false"><h3 class="kpi-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3><div><span class="kpi-value">1520</span><span class="kpi-unit">Ø·Ù„Ø¨</span></div></div>
                            <div class="kpi-card text-center" data-animate-value="false"><h3 class="kpi-title">Ø·Ù„Ø¨Ø§Øª Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§</h3><div><span class="kpi-value">980</span><span class="kpi-unit">Ø·Ù„Ø¨</span></div></div>
                            <div class="kpi-card text-center" data-animate-value="false"><h3 class="kpi-title">Ø£Ø±Ø§Ø¶ Ù…Ø®ØµØµØ©</h3><div><span class="kpi-value">855</span><span class="kpi-unit">Ù‚Ø·Ø¹Ø©</span></div></div>
                            <div class="kpi-card text-center" data-animate-value="false"><h3 class="kpi-title">Ù…ØªÙˆØ³Ø· Ù…Ø¯Ø© Ø§Ù„ØªØ®ØµÙŠØµ</h3><div><span class="kpi-value">45</span><span class="kpi-unit">ÙŠÙˆÙ…</span></div></div>
                        </div>
                        <div class="chart-card flex flex-col justify-center items-center" data-chart-id="landTypeChart">
                            <h3 class="chart-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹</h3>
                            <div class="chart-container" style="height: 280px; max-width: 280px;"><canvas id="landTypeChart"></canvas></div>
                            <p class="chart-context">ÙŠØ¹ÙƒØ³ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø·Ù„Ø¨ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù…Ø·Ø±ÙˆØ­Ø© ÙˆØ§Ù„Ù…Ù‚ØªØ±Ø­Ø©.</p>
                        </div>
                    </div>
                </section>

                <section id="execution" class="mb-12">
                    <h2 class="section-title">ğŸš§ Ø±Ø¤ÙŠØ© Ø§Ù„ØªÙ†ÙÙŠØ° ÙˆØ§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                        <div data-kpi-id="completed-projects" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ù…Ø´Ø§Ø±ÙŠØ¹ ØªÙ… ØªÙ†ÙÙŠØ°Ù‡Ø§</h3>
                             <div><span class="kpi-value">412</span><span class="kpi-unit">Ù…Ø´Ø±ÙˆØ¹</span></div>
                        </div>
                        <div data-kpi-id="withdrawn-lands" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ø£Ø±Ø§Ø¶Ù ØªÙ… Ø³Ø­Ø¨Ù‡Ø§</h3>
                             <div><span class="kpi-value">58</span><span class="kpi-unit">Ù‚Ø·Ø¹Ø©</span></div>
                        </div>
                        <div data-kpi-id="late-investors" class="kpi-card kpi-card-interactive kpi-card-warning" data-animate-value="false">
                            <h3 class="kpi-title">Ù…Ø³ØªØ«Ù…Ø±ÙˆÙ† Ù…ØªØ£Ø®Ø±ÙˆÙ†</h3>
                             <div><span class="kpi-value">97</span><span class="kpi-unit">Ù…Ø³ØªØ«Ù…Ø±</span></div>
                        </div>
                    </div>
                </section>
                <section id="investors" class="mb-12">
                    <h2 class="section-title">ğŸ“Š Ù…Ø¤Ø´Ø±Ø§Øª ÙØ§Ø¹Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mb-8 text-center">
                         <div data-kpi-id="registered-investors" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙˆÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙˆÙ†</h3>
                            <div><span class="kpi-value">550</span><span class="kpi-unit">Ù…Ø³ØªØ«Ù…Ø±</span></div>
                        </div>
                        <div data-kpi-id="active-investors" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</h3>
                            <div><span class="kpi-value">215</span><span class="kpi-unit">Ù…Ø³ØªØ«Ù…Ø±</span></div>
                        </div>
                        <div class="kpi-card" data-animate-value="false">
                            <h3 class="kpi-title">Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
                            <div><span class="kpi-value">42</span><span class="kpi-unit">%</span></div>
                        </div>
                        <div class="kpi-card" data-animate-value="false">
                            <h3 class="kpi-title">Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¬Ø¯ÙŠØ¯Ø© Ø´Ù‡Ø±ÙŠØ§Ù‹</h3>
                            <div><span class="kpi-value">15</span><span class="kpi-unit">Ù…Ø´Ø±ÙˆØ¹</span></div>
                        </div>
                    </div>
                    <div class="chart-card" data-chart-id="investorDistributionChart">
                        <h3 class="chart-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</h3>
                        <div class="chart-container"><canvas id="investorDistributionChart"></canvas></div>
                        <p class="chart-context">ÙŠØ¹Ø±Ø¶ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø®Ø·Ø· Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙŠØ¹Ù‡Ù….</p>
                    </div>
                </section>
                <section id="admin" class="mb-12">
                    <h2 class="section-title">â³ Ù…Ø¤Ø´Ø±Ø§Øª Ø²Ù…Ù†ÙŠØ© ÙˆØ¥Ø¯Ø§Ø±ÙŠØ©</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-8 max-w-4xl mx-auto">
                        <div class="kpi-card text-center" data-animate-value="false"><h3 class="kpi-title">Ù…ØªÙˆØ³Ø· Ø²Ù…Ù† Ø§Ù„Ù‚Ø±Ø§Ø±</h3><div><span class="kpi-value">21</span><span class="kpi-unit">ÙŠÙˆÙ…</span></div></div>
                        <div data-kpi-id="delayed-requests" class="kpi-card kpi-card-interactive text-center kpi-card-warning" data-animate-value="false"><h3 class="kpi-title">Ø·Ù„Ø¨Ø§Øª Ù…ØªØ£Ø®Ø±Ø©</h3><div><span class="kpi-value">35</span><span class="kpi-unit">Ø·Ù„Ø¨</span></div></div>
                    </div>
                </section>
                <section id="complaints" class="mb-12">
                    <h2 class="section-title">âš–ï¸ Ø­Ø§Ù„Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„ØªØ¸Ù„Ù…Ø§Øª</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8 text-center">
                        <div data-kpi-id="total-complaints" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</h3>
                            <div><span class="kpi-value">4</span><span class="kpi-unit">Ø´ÙƒÙˆÙ‰</span></div>
                        </div>
                        <div data-kpi-id="resolved-complaints" class="kpi-card kpi-card-interactive" data-animate-value="false">
                            <h3 class="kpi-title">Ø´ÙƒØ§ÙˆÙ‰ ØªÙ… Ø­Ù„Ù‡Ø§</h3>
                            <div><span class="kpi-value">2</span><span class="kpi-unit">Ø´ÙƒÙˆÙ‰</span></div>
                        </div>
                        <div data-kpi-id="pending-complaints" class="kpi-card kpi-card-interactive kpi-card-warning" data-animate-value="false">
                            <h3 class="kpi-title">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
                            <div><span class="kpi-value">2</span><span class="kpi-unit">Ø´ÙƒÙˆÙ‰</span></div>
                        </div>
                    </div>
                    <div class="chart-card" data-chart-id="complaintsChart">
                        <h3 class="chart-title">Ù†Ø³Ø¨Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù…ÙØªÙˆØ­Ø© ÙˆØ§Ù„Ù…ØºÙ„Ù‚Ø©</h3>
                        <div class="chart-container" style="height: 200px;"><canvas id="complaintsChart"></canvas></div>
                        <p class="chart-context">Ù…Ø¤Ø´Ø± Ù„ÙƒÙØ§Ø¡Ø© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†.</p>
                    </div>
                </section>
            </main>
    
            <footer class="text-center mt-12 pt-8 border-t border-gray-300">
                <p class="text-sm text-gray-600 font-light">&copy; 2024 ØµÙ†Ø¯ÙˆÙ‚ Ø§Ø³ØªØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠØŒ Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
            </footer>
        </div>
    </div>

    <!-- Modal and Script -->
    <div id="details-modal-overlay"></div>
    <div id="details-modal-container">
        <div class="modal-header flex justify-between items-center"><h3 id="details-modal-title" class="text-2xl font-bold text-[#285430]"></h3><button id="details-modal-close" class="modal-close-btn">&times;</button></div>
        <div class="modal-body"><div id="details-modal-content"></div></div>
    </div>

    <script defer>
        const mockData = {
            revenue: [
                { name: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙŠÙ„ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©', amount: '500,000', currency: 'Ø¬.Ù…', date: '2024-05-15', method: 'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ', installment: 3 },
                { name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯', amount: '250,000', currency: 'Ø¬.Ù…', date: '2024-05-12', method: 'Ø´ÙŠÙƒ', installment: 1 },
                { name: 'Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª Ø§Ù„ÙˆØ§Ø­Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡', amount: '16,400', currency: '$', date: '2024-05-11', method: 'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ', installment: 5 }
            ],
            duesAmount: [ { name: 'Ù…Ø³ØªØ«Ù…Ø± Ø§Ù„Ø£Ù…Ù„', amount: '120,000 Ø¬.Ù…', dueDate: '2024-04-30' }, { name: 'Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ø®ÙŠØ±', amount: '85,000 Ø¬.Ù…', dueDate: '2024-05-10' }, { name: 'Ø§Ù„Ø±Ù…Ø§Ù„ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©', amount: '210,000 Ø¬.Ù…', dueDate: '2024-03-20' } ],
            overdue: { 
                monthlyDistribution: [{ month: 'ÙŠÙ†Ø§ÙŠØ±', count: 45 }, { month: 'ÙØ¨Ø±Ø§ÙŠØ±', count: 60 }, { month: 'Ù…Ø§Ø±Ø³', count: 55 },{ month: 'Ø£Ø¨Ø±ÙŠÙ„', count: 75 }, { month: 'Ù…Ø§ÙŠÙˆ', count: 65 }, { month: 'ÙŠÙˆÙ†ÙŠÙˆ', count: 85 }],
                yearlyDistribution: [{ year: '2022', count: 120 }, { year: '2023', count: 210 }, { year: '2024', count: 95 }],
                details: [{ name: 'Ø´Ø±ÙƒØ© Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡', installment: 2, amount: '75,000 Ø¬.Ù…', dueDate: '2024-06-01' },{ name: 'Ù…Ø³ØªØ«Ù…Ø± Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„', installment: 4, amount: '90,000 Ø¬.Ğ¼', dueDate: '2024-06-05' },] 
            },
            completedProjects: [{ name: 'Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù‚Ù…Ø­ Ø§Ù„Ø°Ù‡Ø¨ÙŠ', investor: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙŠÙ„ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©', date: '2023-12-20', area: '500 ÙØ¯Ø§Ù†' },{ name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ø²ÙŠØªÙˆÙ† Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ', investor: 'Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„ÙˆØ§Ø­Ø§Øª', date: '2024-02-11', area: '1200 ÙØ¯Ø§Ù†' },],
            withdrawnLands: [
                { investor: 'Ø´Ø±ÙƒØ© Ø§Ù„Ø±Ù…Ø§Ù„ Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©', landId: 'Ù‚-884-Ø¨', reason: 'Ø¹Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ©', date: '2024-03-01', withdrawalRecordDate: '2024-02-20', decisionNumber: '155', decisionAuthority: 'Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©', withdrawalDecision: 'Ø³Ø­Ø¨ Ù†Ù‡Ø§Ø¦ÙŠ' },
                { investor: 'Ù…Ø³ØªØ«Ù…Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ', landId: 'Ø³-101-Ø¬', reason: 'Ù…Ø®Ø§Ù„ÙØ© Ø´Ø±ÙˆØ· Ø§Ù„ØªØ¹Ø§Ù‚Ø¯', date: '2024-05-18', withdrawalRecordDate: '2024-05-10', decisionNumber: '189', decisionAuthority: 'Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ù…Ø­Ø§ÙØ¸', withdrawalDecision: 'Ø¥Ù†Ø°Ø§Ø± Ø¨Ø§Ù„Ø³Ø­Ø¨' },
            ],
            lateInvestors: [{ name: 'Ù…Ø³ØªØ«Ù…Ø± Ø§Ù„Ø£Ù…Ù„', overdueAmount: '120,000 Ø¬.Ù…', lastPayment: '2023-11-01', phone: '01001234567' },{ name: 'Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ø®ÙŠØ±', overdueAmount: '85,000 Ø¬.Ù…', lastPayment: '2024-01-15', phone: '01223456789' },],
            registeredInvestors: [{ name: 'Ø´Ø±ÙƒØ© Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ø¶Ø©', joinDate: '2022-01-15', status: 'Ù†Ø´Ø·' },{ name: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙÙ‚ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©', joinDate: '2022-03-10', status: 'Ù†Ø´Ø·' },{ name: 'Ù…Ø³ØªØ«Ù…Ø± ÙØ±Ø¯ÙŠ', joinDate: '2024-06-01', status: 'Ø¬Ø¯ÙŠØ¯' },],
            activeInvestors: [{ name: 'Ø´Ø±ÙƒØ© Ø§Ù„ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ø¶Ø©', lastActivity: '2024-06-12', openProjects: 3 },{ name: 'Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£ÙÙ‚ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©', lastActivity: '2024-06-10', openProjects: 1 },],
            delayedRequests: [{ id: 'Ø·Ù„Ø¨-1984', type: 'ØªØ®ØµÙŠØµ Ø£Ø±Ø¶', submitted: '2024-04-01', daysDelayed: 38 },{ id: 'Ø·Ù„Ø¨-2011', type: 'ØªØºÙŠÙŠØ± Ù†Ø´Ø§Ø·', submitted: '2024-04-15', daysDelayed: 24 },],
            complaints: [ { id: 'C-001', investor: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙŠÙ„', subject: 'ØªØ£Ø®Ø± ÙÙŠ Ø§Ù„Ø±Ø¯', date: '2024-06-01', status: 'Ù…ØºÙ„Ù‚Ø©', resolutionDate: '2024-06-05' }, { id: 'C-002', investor: 'Ù…Ø³ØªØ«Ù…Ø± Ø§Ù„Ø£Ù…Ù„', subject: 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©', date: '2024-06-02', status: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©', resolutionDate: null }, ],
            monthlyRevenue: [10.2, 11.5, 11.1, 12.8, 12.5, 13.2],
            centerRevenue: [ { name: 'Ù…Ø±ÙƒØ² Ø§Ù„Ø®Ø§Ø±Ø¬Ø©', revenue: 22.5 }, { name: 'Ù…Ø±ÙƒØ² Ø§Ù„Ø¯Ø§Ø®Ù„Ø©', revenue: 18.1 }, { name: 'Ù…Ø±ÙƒØ² Ø§Ù„ÙØ±Ø§ÙØ±Ø©', revenue: 15.8 }, { name: 'Ù…Ø±ÙƒØ² Ø¨Ø§Ø±ÙŠØ³', revenue: 11.4 }, { name: 'Ù…Ø±ÙƒØ² Ø¨Ù„Ø§Ø·', revenue: 7.6 }, ]
        };

        const icons = {
            user: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>`,
            money: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M8.433 7.418c.158-.103.346-.196.567-.267v1.698a2.5 2.5 0 004 0V7.15c.22.07.408.164.567.267C13.96 7.888 14 8.242 14 8.5v1.5a2.5 2.5 0 005 0V9a1 1 0 00-1-1h-.547l-1.35-1.35A.5.5 0 0015.5 6H14V5a1 1 0 00-1-1H7a1 1 0 00-1 1v1H4.5a.5.5 0 00-.354.146L2.793 7.5H2a1 1 0 00-1 1v1.5a2.5 2.5 0 005 0V8.5c0-.258-.04-.612-.433-1.082zM3 12.5a2.5 2.5 0 015 0V14a1 1 0 01-1 1H4a1 1 0 01-1-1v-1.5zM12 12.5a2.5 2.5 0 015 0V14a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1.5z" /></svg>`,
            calendar: `<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd" /></svg>`,
        };

        document.addEventListener('DOMContentLoaded', () => {
            const modalOverlay = document.getElementById('details-modal-overlay');
            const modalContainer = document.getElementById('details-modal-container');
            const modalTitle = document.getElementById('details-modal-title');
            const modalContent = document.getElementById('details-modal-content');
            const closeModalBtn = document.getElementById('details-modal-close');
            const tooltipConfig = { plugins: { tooltip: { bodyFont: { family: 'Tajawal' }, titleFont: { family: 'Tajawal' }, rtl: true, }, legend: { labels: { font: { family: 'Tajawal', size: 14 } } } }, responsive: true, maintainAspectRatio: false };
            const chartColors = { primary: '#285430', secondary: '#557A46', light: '#A4B0A5', accent: '#D97706', danger: '#be123c' };

            const openModal = () => { modalOverlay.classList.add('visible'); modalContainer.classList.add('visible'); };
            const closeModal = () => { modalOverlay.classList.remove('visible'); modalContainer.classList.remove('visible'); };

            closeModalBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', closeModal);

            const generateContent = (type) => {
                let html = '';
                let title = '';
                const tableTemplate = (headers, rows) => `<div class="overflow-x-auto"><table class="professional-table"><thead><tr>${headers}</tr></thead><tbody>${rows}</tbody></table></div>`;
                
                switch (type) {
                    case 'revenue': 
                        title = 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ØµÙ„Ø©'; 
                        html = tableTemplate(
                            `<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>${icons.money}Ø§Ù„Ù…Ø¨Ù„Øº</th><th>${icons.calendar}Ø§Ù„ØªØ§Ø±ÙŠØ®</th>`, 
                            mockData.revenue.map(item => 
                                `<tr>
                                    <td>${item.name}</td>
                                    <td class="amount">${item.amount} ${item.currency}</td>
                                    <td>${item.date}</td>
                                </tr>`
                            ).join('')
                        ); 
                        break;
                    case 'dues-amount': title = 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©'; html = tableTemplate(`<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>${icons.money}Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚</th><th>${icons.calendar}ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</th>`, mockData.duesAmount.map(item => `<tr><td>${item.name}</td><td class="amount overdue">${item.amount}</td><td>${item.dueDate}</td></tr>`).join('')); break;
                    case 'overdue': 
                        title = 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©'; 
                        html = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                            <div>
                                <h4 class="text-lg font-semibold text-gray-700 mb-3">Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ù„Ø³Ù†Ù‡ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                                <div class="grid grid-cols-3 gap-4">
                                    ${mockData.overdue.monthlyDistribution.map(item => `
                                        <div class="bg-amber-100 p-3 rounded-lg text-center border border-amber-200">
                                            <div class="font-bold text-amber-800">${item.month}</div>
                                            <div class="text-2xl font-extrabold text-amber-600">${item.count}</div>
                                        </div>`).join('')}
                                </div>
                            </div>
                            <div>
                                <h4 class="text-lg font-semibold text-gray-700 mb-3">Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ù„Ø³Ù†ÙˆØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h4>
                                <div class="grid grid-cols-3 gap-4">
                                    ${mockData.overdue.yearlyDistribution.map(item => `
                                        <div class="bg-sky-100 p-3 rounded-lg text-center border border-sky-200">
                                            <div class="font-bold text-sky-800">${item.year}</div>
                                            <div class="text-2xl font-extrabold text-sky-600">${item.count}</div>
                                        </div>`).join('')}
                                </div>
                            </div>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-3 mt-6">Ø¹ÙŠÙ†Ø© Ù…Ù† Ø§Ù„Ø£Ù‚Ø³Ø§Ø·</h4>` + 
                        tableTemplate(`<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th># Ø§Ù„Ù‚Ø³Ø·</th><th>${icons.money}Ø§Ù„Ù…Ø¨Ù„Øº</th><th>${icons.calendar}ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</th>`, mockData.overdue.details.map(item => `<tr><td>${item.name}</td><td class="text-center">${item.installment}</td><td class="amount overdue">${item.amount}</td><td>${item.dueDate}</td></tr>`).join('')); 
                        break;
                    case 'completed-projects': title = 'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ù†ÙØ°Ø©'; html = tableTemplate(`<th>Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</th><th>Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªÙ…Ø§Ù„</th><th>Ø§Ù„Ù…Ø³Ø§Ø­Ø©</th>`, mockData.completedProjects.map(item => `<tr><td>${item.name}</td><td>${item.investor}</td><td>${item.date}</td><td>${item.area}</td></tr>`).join('')); break;
                    case 'withdrawn-lands': 
                        title = 'Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨Ø©'; 
                        html = tableTemplate(
                            `<th>Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø·Ø¹Ø©</th><th>Ø³Ø¨Ø¨ Ø§Ù„Ø³Ø­Ø¨</th><th>ØªØ§Ø±ÙŠØ® Ù…Ø­Ø¶Ø± Ø§Ù„Ø³Ø­Ø¨</th><th>Ø±Ù‚Ù… Ø§Ù„Ù‚Ø±Ø§Ø±</th><th>Ø¬Ù‡Ø© Ø§Ù„Ù‚Ø±Ø§Ø±</th><th>Ù‚Ø±Ø§Ø± Ø§Ù„Ø³Ø­Ø¨</th>`, 
                            mockData.withdrawnLands.map(item => 
                                `<tr>
                                    <td>${item.investor}</td>
                                    <td>${item.landId}</td>
                                    <td class="amount overdue">${item.reason}</td>
                                    <td>${item.withdrawalRecordDate}</td>
                                    <td>${item.decisionNumber}</td>
                                    <td>${item.decisionAuthority}</td>
                                    <td>${item.withdrawalDecision}</td>
                                </tr>`
                            ).join('')
                        ); 
                        break;
                    case 'late-investors': title = 'Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙˆÙ† Ø§Ù„Ù…ØªØ£Ø®Ø±ÙˆÙ† ÙÙŠ Ø§Ù„Ø³Ø¯Ø§Ø¯'; html = tableTemplate(`<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>${icons.money}Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…ØªØ£Ø®Ø±</th><th>ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ø³Ø¯Ø§Ø¯</th><th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>`, mockData.lateInvestors.map(item => `<tr><td>${item.name}</td><td class="amount overdue">${item.overdueAmount}</td><td>${item.lastPayment}</td><td>${item.phone}</td></tr>`).join('')); break;
                    case 'registered-investors': title = 'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†'; html = tableTemplate(`<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th>`, mockData.registeredInvestors.map(item => `<tr><td>${item.name}</td><td>${item.joinDate}</td><td><span class="px-2 py-1 font-semibold leading-tight ${item.status === 'Ù†Ø´Ø·' ? 'text-green-700 bg-green-100' : 'text-blue-700 bg-blue-100'} rounded-full">${item.status}</span></td></tr>`).join('')); break;
                    case 'active-investors': title = 'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†'; html = tableTemplate(`<th>${icons.user}Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</th><th>Ø¢Ø®Ø± Ù†Ø´Ø§Ø·</th><th>Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…ÙØªÙˆØ­Ø©</th>`, mockData.activeInvestors.map(item => `<tr><td>${item.name}</td><td>${item.lastActivity}</td><td class="text-center">${item.openProjects}</td></tr>`).join('')); break;
                    case 'delayed-requests': title = 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ£Ø®Ø±Ø© Ø¹Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ'; html = tableTemplate(`<th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</th><th>Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±</th>`, mockData.delayedRequests.map(item => `<tr><td>${item.id}</td><td>${item.type}</td><td>${item.submitted}</td><td class="text-center amount overdue">${item.daysDelayed}</td></tr>`).join('')); break;
                    case 'total-complaints': title = 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„ØªØ¸Ù„Ù…Ø§Øª'; html = tableTemplate(`<th>Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ù„Ù…Ø´ØªÙƒÙŠ</th><th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th><th>ØªØ§Ø±ÙŠØ®Ù‡Ø§</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th>`, mockData.complaints.map(item => `<tr><td>${item.id}</td><td>${item.investor}</td><td>${item.subject}</td><td>${item.date}</td><td><span class="status-badge ${item.status === 'Ù…ØºÙ„Ù‚Ø©' ? 'resolved' : 'pending'}">${item.status}</span></td></tr>`).join('')); break;
                    case 'resolved-complaints': title = 'Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ Ø§Ù„ØªÙŠ ØªÙ… Ø­Ù„Ù‡Ø§'; html = tableTemplate(`<th>Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ù„Ù…Ø´ØªÙƒÙŠ</th><th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ù„</th>`, mockData.complaints.filter(c => c.status === 'Ù…ØºÙ„Ù‚Ø©').map(item => `<tr><td>${item.id}</td><td>${item.investor}</td><td>${item.subject}</td><td>${item.resolutionDate}</td></tr>`).join('')); break;
                    case 'pending-complaints': title = 'Ø´ÙƒØ§ÙˆÙ‰ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'; html = tableTemplate(`<th>Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th><th>Ø§Ù„Ù…Ø´ØªÙƒÙŠ</th><th>Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹</th><th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</th>`, mockData.complaints.filter(c => c.status === 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©').map(item => `<tr><td>${item.id}</td><td>${item.investor}</td><td>${item.subject}</td><td>${item.date}</td></tr>`).join('')); break;
                }
                modalTitle.innerText = title;
                modalContent.innerHTML = html;
            };

            document.querySelectorAll('.kpi-card-interactive').forEach(card => {
                card.addEventListener('click', () => {
                    const kpiId = card.dataset.kpiId;
                    if(kpiId) {
                        generateContent(kpiId);
                        openModal();
                    }
                });
            });
        
            function animateValue(element, start, end, duration, isDecimal = true) {
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    const currentValue = progress * (end - start) + start;
                    element.textContent = isDecimal ? currentValue.toFixed(1) : Math.floor(currentValue);
                    if (progress < 1) { window.requestAnimationFrame(step); } 
                    else { element.textContent = isDecimal ? end.toFixed(1) : end; }
                };
                window.requestAnimationFrame(step);
            }

            const topCenterEl = document.getElementById('top-revenue-center');
            const topCenter = mockData.centerRevenue.reduce((prev, current) => (prev.revenue > current.revenue) ? prev : current);
            topCenterEl.textContent = topCenter.name;

            const chartInitializer = (entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const chartId = entry.target.dataset.chartId;
                        const kpiCardEl = entry.target.hasAttribute('data-animate-kpi');
                        const animatedValueEl = entry.target.querySelector('.kpi-value');

                        if (kpiCardEl && !entry.target.isAnimated) {
                            entry.target.isAnimated = true; // Prevents re-animation on scroll
                            const trendValueEl = document.getElementById('trend-kpi-value');
                            const trendIndicatorEl = document.getElementById('trend-indicator');
                            const monthlyRevenueData = mockData.monthlyRevenue;
                            const currentMonthRevenue = monthlyRevenueData[monthlyRevenueData.length - 1];
                            const previousMonthRevenue = monthlyRevenueData[monthlyRevenueData.length - 2];
                            const percentageChange = ((currentMonthRevenue - previousMonthRevenue) / previousMonthRevenue) * 100;
                            const isUp = percentageChange >= 0;
                            
                            animateValue(trendValueEl, 0, currentMonthRevenue, 1500);
                            trendIndicatorEl.classList.add(isUp ? 'up' : 'down');
                            trendIndicatorEl.classList.remove(isUp ? 'down' : 'up');
                            const arrow = isUp ? `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18" /></svg>` : `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 13.5L12 21m0 0l-7.5-7.5M12 21V3" /></svg>`;
                            const percentageSpan = document.createElement('span');
                            percentageSpan.textContent = '0.0';
                            trendIndicatorEl.innerHTML = `${arrow}`;
                            trendIndicatorEl.appendChild(percentageSpan);
                            percentageSpan.append('%');
                            animateValue(percentageSpan, 0, Math.abs(percentageChange), 1500);
                            
                            new Chart(document.getElementById('revenueTrendChart'), { type: 'line', data: { labels: ['', '', '', '', '', ''], datasets: [{ data: monthlyRevenueData, borderColor: 'white', borderWidth: 2, fill: true, backgroundColor: 'rgba(255, 255, 255, 0.1)', tension: 0.4 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { enabled: false } }, scales: { x: { display: false }, y: { display: false } }, elements: { point: { radius: 0 } } } });
                            
                            observer.unobserve(entry.target);
                        }
                        
                        if (entry.target.hasAttribute('data-animate-value') && !entry.target.isAnimated) {
                            entry.target.isAnimated = true;
                            const isDecimal = entry.target.dataset.animateValue === 'true';
                            const value = parseFloat(animatedValueEl.textContent);
                            animateValue(animatedValueEl, 0, value, 1500, isDecimal);
                            observer.unobserve(entry.target);
                        }

                        if (chartId && !entry.target.chart) {
                             switch(chartId) {
                                 case 'overdueInstallmentsChart': entry.target.chart = new Chart(document.getElementById('overdueInstallmentsChart'), { type: 'bar', data: { labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'], datasets: [{ label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‚Ø³Ø§Ø· Ø§Ù„Ù…ØªØ£Ø®Ø±Ø©', data: [45, 60, 55, 75, 65, 85], backgroundColor: chartColors.secondary, borderColor: chartColors.primary, borderWidth: 1, borderRadius: 5 }] }, options: { ...tooltipConfig, scales: { y: { beginAtZero: true, ticks: { font: { family: 'Tajawal' } } }, x: { ticks: { font: { family: 'Tajawal' } } } } } }); break;
                                 case 'revenueByCenterChart': entry.target.chart = new Chart(document.getElementById('revenueByCenterChart'), { type: 'bar', data: { labels: mockData.centerRevenue.map(c => c.name), datasets: [{ label: 'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø¨Ø§Ù„Ù…Ù„ÙŠÙˆÙ†', data: mockData.centerRevenue.map(c => c.revenue), backgroundColor: [chartColors.primary, chartColors.secondary, chartColors.light, chartColors.accent, '#A47E3B'], borderWidth: 0, borderRadius: 5 }] }, options: { ...tooltipConfig, indexAxis: 'y', plugins: { ...tooltipConfig.plugins, legend: { display: false } }, scales: { y: { ticks: { font: { family: 'Tajawal' } } }, x: { ticks: { font: { family: 'Tajawal' } } } } } }); break;
                                 case 'landTypeChart': entry.target.chart = new Chart(document.getElementById('landTypeChart'), { type: 'doughnut', data: { labels: ['Ø£Ø±Ø§Ø¶Ù Ù…Ø·Ø±ÙˆØ­Ø©', 'Ø£Ø±Ø§Ø¶Ù Ù…Ù‚ØªØ±Ø­Ø©'], datasets: [{ data: [68, 32], backgroundColor: [chartColors.primary, chartColors.light], borderColor: '#ffffff', borderWidth: 4 }] }, options: { ...tooltipConfig, plugins: { ...tooltipConfig.plugins, legend: { position: 'bottom', ...tooltipConfig.plugins.legend } } } }); break;
                                 case 'investorDistributionChart': entry.target.chart = new Chart(document.getElementById('investorDistributionChart'), { type: 'bar', data: { labels: ['Ø£Ù‚Ù„ Ù…Ù† 1Ù…', '1-5Ù…', '5-10Ù…', 'Ø£ÙƒØ«Ø± Ù…Ù† 10Ù…'], datasets: [{ label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†', data: [110, 65, 32, 8], backgroundColor: [chartColors.light, chartColors.secondary, chartColors.primary, chartColors.accent], borderWidth: 0, borderRadius: 5 }] }, options: { ...tooltipConfig, plugins: { ...tooltipConfig.plugins, legend: { display: false } }, scales: { y: { beginAtZero: true, ticks: { font: { family: 'Tajawal' } } }, x: { ticks: { font: { family: 'Tajawal' } } } } } }); break;
                                 case 'complaintsChart': const resolvedCount = mockData.complaints.filter(c => c.status === 'Ù…ØºÙ„Ù‚Ø©').length; const pendingCount = mockData.complaints.filter(c => c.status === 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©').length; entry.target.chart = new Chart(document.getElementById('complaintsChart'), { type: 'bar', data: { labels: ['Ø­Ø§Ù„Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰'], datasets: [{ label: 'Ù…ØºÙ„Ù‚Ø©', data: [resolvedCount], backgroundColor: chartColors.secondary, borderRadius: 5 }, { label: 'Ù…ÙØªÙˆØ­Ø©', data: [pendingCount], backgroundColor: chartColors.danger, borderRadius: 5 }] }, options: { ...tooltipConfig, indexAxis: 'y', scales: { x: { stacked: true, ticks: { callback: (v) => v, font: { family: 'Tajawal' } } }, y: { stacked: true, ticks: { font: { family: 'Tajawal' } } } } } }); break;
                             }
                             observer.unobserve(entry.target);
                        }
                    }
                });
            };
            const chartObserver = new IntersectionObserver(chartInitializer, { rootMargin: "0px", threshold: 0.1 });
            document.querySelectorAll('[data-chart-id], [data-animate-kpi], [data-animate-value]').forEach(el => chartObserver.observe(el));
        });
    </script>
</body>
</html>
